<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cart Page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="product-listing.css">
  <link rel="stylesheet" href="product-detail.css">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="topbar container">
      <div class="logo">
        <img src="images/logo-colored.png" alt="Brand Logo" class="logo-img">
      </div>
      <div class="icondiv">
        <a href="profile.html" class="icon"><i class="bi bi-person-fill"></i><span>Profile</span></a>
        <a href="messages.html" class="icon"><i class="bi bi-chat-dots"></i><span>Message</span></a>
        <a href="orders.html" class="icon"><i class="bi bi-heart-fill"></i><span>Orders</span></a>
        <a href="cart.html" class="icon"><i class="bi bi-cart3"></i><span>My Cart</span></a>
      </div>
    </div>
  </header>

  <!-- Cart and Summary -->
  <div class="container d-lg-flex align-items-start justify-content-between mb-4">
    <!-- Cart Items -->
    <div class="col-lg-8">
      <h3>My Cart</h3>
      <div id="cart-items" style="background-color: white;"></div>
    </div>

    <!-- Order Summary -->
    <div class="col-lg-4">
      <h5 class="invisible mb-3">Spacer</h5>
      <div id="cart-summary" class="p-3 border rounded" style="background-color: white;"></div>
    </div>
  </div>

  <!-- Feature Icons Section -->
  <div class="container py-4 mb-4" style="background-color: #f8f9fa; border-radius: 10px;">
    <div class="row text-center">
      <div class="col-md-4 mb-3 mb-md-0">
        <div>
          <i class="bi bi-lock-fill fs-3 text-secondary bg-light p-2 rounded-circle"></i>
          <h6 class="mt-2 mb-0 fw-semibold">Secure payment</h6>
          <p class="text-muted small">Have you ever finally just</p>
        </div>
      </div>
      <div class="col-md-4 mb-3 mb-md-0">
        <div>
          <i class="bi bi-chat-dots-fill fs-3 text-secondary bg-light p-2 rounded-circle"></i>
          <h6 class="mt-2 mb-0 fw-semibold">Customer support</h6>
          <p class="text-muted small">Have you ever finally just</p>
        </div>
      </div>
      <div class="col-md-4">
        <div>
          <i class="bi bi-truck fs-3 text-secondary bg-light p-2 rounded-circle"></i>
          <h6 class="mt-2 mb-0 fw-semibold">Free delivery</h6>
          <p class="text-muted small">Have you ever finally just</p>
        </div>
      </div>
    </div>
  </div>

<!-- Saved for Later Section -->
<div class="container d-flex justify-content-center my-4">
  <div style="background-color: white; padding: 24px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); width: 100%;">
    <h5 class="mb-3">Saved for later</h5>
    <div id="saved-items" class="d-flex flex-nowrap overflow-auto gap-3 pb-2"></div>
  </div>
</div>


<!-- Back to Shop Button -->
<div class="container text-center my-4">
  <a href="product-listing.html" class="btn btn-primary px-4 py-2">
    <i class="bi bi-arrow-left-circle me-2"></i>
    Back to shop
  </a>
</div>




  <!-- Banner -->
  <div class="container discount-banner mb-4">
    <div class="banner-text">
      <h3>Super discount on more than 100 USD</h3>
      <p>Have you ever finally just write dummy info</p>
    </div>
    <button class="shop-btn">Shop now</button>
  </div>

  <!-- Footer -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script src="main.js"></script>
  <script src="product-listing.js"></script>
  <script src="product-detail.js"></script>
  <script>
    function renderCart() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const saved = JSON.parse(localStorage.getItem("savedForLater")) || [];

      const cartItems = document.getElementById("cart-items");
      const savedItems = document.getElementById("saved-items");
      const summary = document.getElementById("cart-summary");

      cartItems.innerHTML = "";
      savedItems.innerHTML = "";
      let subtotal = 0;

      if (cart.length === 0) {
        cartItems.innerHTML = `
          <div class="d-flex justify-content-center align-items-center w-100" style="min-height: 250px;">
            <div class="text-center text-muted p-4" style="font-size: 1.1rem; border: 1px dashed #ccc; border-radius: 10px;">
              <i class="bi bi-cart-x-fill me-2" style="font-size: 1.5rem;"></i>
              Your cart is currently empty
            </div>
          </div>
        `;
        summary.innerHTML = "";
      } else {
        cartItems.innerHTML = cart.map((item, index) => {
          let itemTotal = item.price * item.quantity;
          subtotal += itemTotal;

          return `
            <div class="d-flex align-items-start justify-content-between border rounded mb-3 p-3">
              <img src="${item.image}" width="90" class="me-3 rounded border">
              <div class="flex-grow-1">
                <h5>${item.title}</h5>
                <p>Material: Plastic<br>Seller: Artel Market</p>
                <select onchange="changeQty(${index}, this.value)" class="form-select form-select-sm mb-2" style="width:100px">
                  ${[...Array(10)].map((_, i) => `<option value="${i+1}" ${item.quantity === i+1 ? 'selected' : ''}>Qty: ${i+1}</option>`).join("")}
                </select><br>
                <button class="btn btn-sm btn-danger" onclick="removeItem(${index})">Remove</button>
                <button class="btn btn-sm btn-outline-secondary ms-2" onclick="saveForLater(${index})">Save for later</button>
              </div>
              <div><strong>$${itemTotal.toFixed(2)}</strong></div>
            </div>
          `;
        }).join("");

        const discount = subtotal >= 100 ? 60 : 0;
        const tax = 14;
        const total = subtotal - discount + tax;

        summary.innerHTML = `
          <h5>Order Summary</h5>
          <p>Subtotal: $${subtotal.toFixed(2)}</p>
          <p>Discount: -$${discount.toFixed(2)}</p>
          <p>Tax: +$${tax.toFixed(2)}</p>
          <hr>
          <h4>Total: $${total.toFixed(2)}</h4>
          <button class="btn btn-success w-100 mt-2">Checkout</button>
        `;
      }

      // Saved for later
const validSaved = saved.filter(item => item && item.image && item.title);

if (validSaved.length === 0) {
  savedItems.innerHTML = `
    <div class="d-flex justify-content-center align-items-center w-100" style="min-height: 200px;">
      <div class="text-center text-muted p-4" style="font-size: 1.1rem; border: 1px dashed #ccc; border-radius: 10px;">
        <i class="bi bi-inbox-fill me-2" style="font-size: 1.5rem;"></i>
        Nothing is saved for later
      </div>
    </div>
  `;
} else {
  savedItems.innerHTML = validSaved.map((item, index) => `
    <div class="card" style="min-width: 200px; flex: 0 0 auto;">
      <img src="${item.image}" class="card-img-top p-3" style="height: 160px; object-fit: contain;" alt="${item.title}">
      <div class="card-body text-center">
        <p class="mb-1"><strong>$${item.price.toFixed(2)}</strong></p>
        <p class="text-muted small">${item.title}</p>
        <button class="btn btn-primary btn-sm w-100" onclick="moveToCart(${index})">
          <i class="bi bi-cart-plus me-1"></i>Move to cart
        </button>
      </div>
    </div>
  `).join("");
}

    }

    function changeQty(index, qty) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart[index].quantity = parseInt(qty);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function removeItem(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function saveForLater(index) {
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      let saved = JSON.parse(localStorage.getItem("savedForLater")) || [];
      saved.push(cart[index]);
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      localStorage.setItem("savedForLater", JSON.stringify(saved));
      renderCart();
    }

    function moveToCart(index) {
      let saved = JSON.parse(localStorage.getItem("savedForLater")) || [];
      let cart = JSON.parse(localStorage.getItem("cart")) || [];
      saved[index].quantity = 1;
      cart.push(saved[index]);
      saved.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      localStorage.setItem("savedForLater", JSON.stringify(saved));
      renderCart();
    }

    window.onload = renderCart;
  </script>
</body>
</html>
